<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test de Worth</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background-color: #f5f5f5;
        padding: 20px;
        min-height: 100vh;
      }
      .container {
        max-width: 1000px;
        margin: 0 auto;
      }
      .page {
        display: none;
      }
      .page.active {
        display: block;
      }
      /* ===== P√ÅGINA PRINCIPAL ===== */
      .header {
        text-align: center;
        margin-bottom: 30px;
      }
      .icon-circle {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, #5b7cff, #4f5fef);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        box-shadow: 0 4px 15px rgba(91, 124, 255, 0.3);
      }
      .icon-circle svg {
        width: 40px;
        height: 40px;
        stroke: white;
        stroke-width: 2.5;
        fill: none;
      }
      h1 {
        font-size: 2.2rem;
        color: #1a1a1a;
        margin-bottom: 10px;
        font-weight: 700;
      }
      .subtitle {
        color: #666;
        font-size: 1rem;
        line-height: 1.5;
      }
      .info-box {
        background: #e8f2ff;
        border: 1px solid #b3d7ff;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 25px;
      }
      .info-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
      }
      .info-icon {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        border: 2px solid #4f5fef;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #4f5fef;
        font-weight: bold;
        font-size: 14px;
      }
      .info-title {
        color: #1a50a0;
        font-weight: 600;
        font-size: 1rem;
      }
      .info-list {
        list-style: none;
        counter-reset: item;
      }
      .info-list li {
        counter-increment: item;
        margin-bottom: 12px;
        padding-left: 30px;
        position: relative;
        color: #333;
        line-height: 1.6;
      }
      .info-list li::before {
        content: counter(item) ".";
        position: absolute;
        left: 8px;
        color: #1a50a0;
        font-weight: 600;
      }
      .info-list strong {
        color: #1a50a0;
      }
      .eye-cards {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 25px;
      }
      .eye-card {
        border-radius: 12px;
        padding: 25px 20px;
        text-align: center;
      }
      .eye-card.left {
        background: #ffe8e8;
        border: 1px solid #ffcccc;
      }
      .eye-card.right {
        background: #e8ffe8;
        border: 1px solid #ccffcc;
      }
      .eye-icon {
        width: 50px;
        height: 50px;
        margin: 0 auto 12px;
      }
      .eye-icon svg {
        width: 100%;
        height: 100%;
      }
      .eye-card.left .eye-icon svg {
        stroke: #d32f2f;
        fill: none;
        stroke-width: 2;
      }
      .eye-card.right .eye-icon svg {
        stroke: #2e7d32;
        fill: none;
        stroke-width: 2;
      }
      .eye-title {
        font-weight: 600;
        font-size: 1.1rem;
        margin-bottom: 8px;
      }
      .eye-card.left .eye-title {
        color: #b71c1c;
      }
      .eye-card.right .eye-title {
        color: #1b5e20;
      }
      .eye-description {
        font-size: 0.9rem;
      }
      .eye-card.left .eye-description {
        color: #c62828;
      }
      .eye-card.right .eye-description {
        color: #2e7d32;
      }
      .button-group {
        display: flex;
        gap: 12px;
        justify-content: center;
        flex-wrap: wrap;
        margin-bottom: 20px;
      }
      .btn {
        padding: 14px 28px;
        border-radius: 10px;
        border: none;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
      }
      .btn-secondary {
        background: white;
        color: #333;
        border: 1px solid #ddd;
      }
      .btn-secondary:hover {
        background: #f5f5f5;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      .btn-primary {
        background: linear-gradient(135deg, #5b7cff, #4f5fef);
        color: white;
        box-shadow: 0 4px 15px rgba(91, 124, 255, 0.3);
      }
      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(91, 124, 255, 0.4);
      }
      /* ===== P√ÅGINA DE CONFIGURACI√ìN ===== */
      .config-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 30px;
      }
      .config-icon {
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #7c3aed, #6d28d9);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .config-icon svg {
        width: 28px;
        height: 28px;
        stroke: white;
        fill: none;
        stroke-width: 2;
      }
      h2 {
        font-size: 1.8rem;
        color: #1a1a1a;
        font-weight: 700;
      }
      .section-title {
        font-size: 1rem;
        font-weight: 600;
        color: #1a1a1a;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .section-title svg {
        width: 20px;
        height: 20px;
      }
      .option-card {
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .option-card:hover {
        border-color: #5b7cff;
        box-shadow: 0 2px 8px rgba(91, 124, 255, 0.2);
      }
      .option-card.selected {
        border-color: #5b7cff;
        background: #f0f4ff;
      }
      .option-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 8px;
      }
      .option-left {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .option-icon {
        width: 24px;
        height: 24px;
      }
      .option-title {
        font-weight: 600;
        color: #1a1a1a;
        font-size: 1rem;
      }
      .option-card.selected .option-title {
        color: #4f5fef;
      }
      .check-icon {
        width: 24px;
        height: 24px;
        border: 2px solid #e0e0e0;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .option-card.selected .check-icon {
        background: #4f5fef;
        border-color: #4f5fef;
      }
      .check-icon svg {
        width: 14px;
        height: 14px;
        stroke: white;
        stroke-width: 3;
        display: none;
      }
      .option-card.selected .check-icon svg {
        display: block;
      }
      .option-description {
        color: #666;
        font-size: 0.9rem;
        line-height: 1.5;
        margin-left: 36px;
      }
      .distance-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 25px;
      }
      .distance-card {
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 12px;
        padding: 18px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
      }
      .distance-card:hover {
        border-color: #5b7cff;
        box-shadow: 0 2px 8px rgba(91, 124, 255, 0.2);
      }
      .distance-card.selected {
        border-color: #5b7cff;
        background: #f0f4ff;
      }
      .distance-main {
        font-size: 1.8rem;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 5px;
      }
      .distance-card.selected .distance-main {
        color: #4f5fef;
      }
      .distance-sub {
        color: #666;
        font-size: 0.85rem;
        margin-bottom: 8px;
      }
      .distance-detail {
        display: flex;
        align-items: center;
        gap: 5px;
        color: #999;
        font-size: 0.8rem;
        margin-bottom: 8px;
      }
      .distance-detail svg {
        width: 14px;
        height: 14px;
      }
      .vision-badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 0.75rem;
        font-weight: 600;
      }
      .badge-cerca {
        background: #d4edda;
        color: #155724;
      }
      .distance-check {
        position: absolute;
        top: 12px;
        right: 12px;
        width: 20px;
        height: 20px;
        border: 2px solid #e0e0e0;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .distance-card.selected .distance-check {
        background: #4f5fef;
        border-color: #4f5fef;
      }
      .distance-check svg {
        width: 12px;
        height: 12px;
        stroke: white;
        stroke-width: 3;
        display: none;
      }
      .distance-card.selected .distance-check svg {
        display: block;
      }
      /* Ajustes avanzados */
      .advanced-section {
        background: white;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 25px;
      }
      .advanced-title {
        font-weight: 600;
        color: #1a1a1a;
        margin-bottom: 20px;
      }
      .slider-group {
        margin-bottom: 20px;
      }
      .slider-label {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 0.9rem;
        color: #333;
      }
      .slider-range {
        font-size: 0.8rem;
        color: #999;
      }
      input[type="range"] {
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: #e0e0e0;
        outline: none;
        -webkit-appearance: none;
      }
      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #4f5fef;
        cursor: pointer;
      }
      input[type="range"]::-moz-range-thumb {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #4f5fef;
        cursor: pointer;
        border: none;
      }
      .color-options {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
        margin-bottom: 20px;
      }
      .color-option {
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        padding: 12px;
        cursor: pointer;
        text-align: center;
        transition: all 0.3s ease;
      }
      .color-option:hover {
        border-color: #5b7cff;
      }
      .color-option.selected {
        border-color: #5b7cff;
        background: #f0f4ff;
      }
      .color-sample {
        height: 40px;
        border-radius: 6px;
        margin-bottom: 8px;
      }
      .color-black {
        background: #000000;
      }
      .color-dark-gray {
        background: #333333;
      }
      .color-gray {
        background: #808080;
      }
      .color-label {
        font-size: 0.85rem;
        color: #666;
        font-weight: 500;
      }
      /* Vista previa */
      .preview-section {
        background: #1e293b;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 25px;
      }
      .preview-title {
        color: white;
        text-align: center;
        font-weight: 600;
        margin-bottom: 20px;
      }
      .preview-canvas {
        background: #000;
        border-radius: 8px;
        width: min(100%, 400px);
        aspect-ratio: 1 / 1; /* CUADRADO */
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        margin: 0 auto;
      }

      /* <<< CAMBIO IMPORTANTE >>> */
      .dot {
        position: absolute;
        border-radius: 50%;
        box-shadow: none; /* sin resplandor por defecto */
        filter: none; /* sin brillo extra por defecto */
      }
      /* Solo la bola blanca tendr√° resplandor */
      .glow-dot {
        box-shadow: 0 0 16px rgba(255, 255, 255, 0.85);
      }
      /* <<< FIN CAMBIO >>> */

      .dot-white {
        background: #ffffff;
        color: #ffffff;
        bottom: 30%;
        left: 50%;
        transform: translateX(-50%);
      }
      .dot-red {
        background: #cc0000;
        color: #cc0000;
        top: 30%;
        left: 50%;
        transform: translateX(-50%);
      }
      .dot-red-right {
        background: #009933;
        color: #009933;
        top: 50%;
        left: 8%;
        transform: translateY(-50%);
      }

      .dot-green {
        background: #009933;
        color: #009933;
        top: 50%;
        right: 8%;
        transform: translateY(-50%);
      }
      .preview-info {
        text-align: center;
        color: #94a3b8;
        font-size: 0.85rem;
        margin-top: 15px;
      }
      @media (max-width: 768px) {
        h1 {
          font-size: 1.8rem;
        }
        h2 {
          font-size: 1.5rem;
        }
        .eye-cards {
          grid-template-columns: 1fr;
        }
        .button-group {
          flex-direction: column;
        }
        .btn {
          width: 100%;
          justify-content: center;
        }
        .distance-grid {
          grid-template-columns: 1fr;
        }
        .color-options {
          grid-template-columns: 1fr;
        }
      }
      /* ===== PANTALLAS FULLSCREEN: INSTRUCCIONES / TEST / RESPUESTAS ===== */
      #instructionsPage,
      #testPage,
      #answerPage,
      #resultsPage {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        height: -webkit-fill-available;
        z-index: 1000;
      }
      #instructionsPage,
      #testPage,
      #answerPage,
      #resultsPage {
        display: none;
      }
      #instructionsPage.active,
      #testPage.active,
      #answerPage.active {
        display: flex;
        flex-direction: column;
      }
      /* Instrucciones */
      .instructions-header {
        background: white;
        padding: 20px;
        border-bottom: 1px solid #e0e0e0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .instructions-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 5px;
      }
      .instructions-subtitle {
        font-size: 1rem;
        color: #666;
      }
      .step-indicator {
        background: #f0f4ff;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        color: #4f5fef;
        display: inline-block;
        margin-top: 10px;
      }
      .instructions-body {
        flex: 1;
        overflow-y: auto;
        padding: 40px 20px 20px 20px;
        display: flex;
        align-items: flex-start;
        justify-content: center;
      }
      .instructions-content {
        max-width: 700px;
        width: 100%;
      }
      .info-card {
        background: linear-gradient(135deg, #e8e0ff, #f0e8ff);
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
      }
      .info-card-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
      }
      .info-icon-full {
        width: 60px;
        height: 60px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }
      .info-icon-full svg {
        width: 32px;
        height: 32px;
        stroke: #7c3aed;
        stroke-width: 2;
        fill: none;
      }
      .info-title-full {
        font-size: 1.3rem;
        font-weight: 700;
        color: #3d1f7a;
      }
      .info-description {
        color: #5b4a7d;
        line-height: 1.7;
        font-size: 1.05rem;
        margin-bottom: 20px;
      }
      .info-list-full {
        list-style: none;
        padding: 0;
      }
      .info-list-full li {
        padding: 12px 0 12px 35px;
        position: relative;
        color: #5b4a7d;
        font-size: 1rem;
        line-height: 1.6;
      }
      .info-list-full li::before {
        content: "‚óè";
        position: absolute;
        left: 10px;
        font-size: 1.2rem;
      }
      .info-list-full li:nth-child(1)::before {
        color: #ff0000;
      }
      .info-list-full li:nth-child(2)::before {
        color: #00ff00;
      }
      .info-list-full li:nth-child(3)::before {
        color: #999;
      }
      .instructions-footer {
        background: white;
        padding: 20px;
        border-top: 1px solid #e0e0e0;
        display: flex;
        justify-content: center;
        gap: 15px;
        position: sticky;
        bottom: 0;
        z-index: 10;
      }
      .btn-next {
        padding: 16px 50px;
        background: linear-gradient(135deg, #5b7cff, #4f5fef);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(91, 124, 255, 0.4);
        transition: all 0.3s ease;
      }
      .btn-next:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(91, 124, 255, 0.5);
      }
      .btn-next:active {
        transform: translateY(0);
      }
      /* TEST FULLSCREEN */
      #testPage {
        background: #000000 !important;
      }
      .test-header {
        background: #1a1a1a;
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: transform 0.3s ease;
      }
      .test-header.hidden {
        transform: translateY(-100%);
      }
      .test-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: white;
      }
      .test-subtitle {
        font-size: 0.9rem;
        color: #999;
      }
      .test-step {
        background: #4f5fef;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        color: white;
      }
      .test-canvas-container {
        flex: 1;
        background: #000000 !important;
        position: relative;
        cursor: pointer;
      }
      /* √°rea cuadrada para mantener proporci√≥n en vertical y horizontal */
      .test-area {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: min(90vw, 90vh);
        height: min(90vw, 90vh);
        background: #000000 !important;
      }
      .dot-test {
        position: absolute;
        border-radius: 50%;
        width: 80px;
        height: 80px;
      }
      .dot-red-1 {
        background: rgb(35, 0, 0); /* un poco m√°s apagado */
        top: 12%;
        left: 50%;
        transform: translateX(-50%);
      }

      /* blanca (con glow mediante .glow-dot) */
      .dot-white-test {
        background: #ffffff;
        bottom: 12%;
        left: 50%;
        transform: translateX(-50%);
      }

      /* rojo/verde laterales, tambi√©n algo m√°s apagados */
      .dot-red-2 {
        background: rgb(0, 50, 0);
        top: 50%;
        left: 15%;
        transform: translateY(-50%);
      }

      .dot-green-test {
        background: rgb(0, 50, 0);
        top: 50%;
        right: 15%;
        transform: translateY(-50%);
      }

      .test-footer {
        background: #1a1a1a;
        padding: 20px;
        display: flex;
        justify-content: center;
        gap: 15px;
        position: sticky;
        bottom: 0;
        z-index: 10;
        transition: transform 0.3s ease;
      }
      .test-footer.hidden {
        transform: translateY(100%);
      }
      /* RESPUESTAS FULLSCREEN */
      .answer-header {
        background: white;
        padding: 20px;
        border-bottom: 1px solid #e0e0e0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .answer-body {
        flex: 1;
        overflow-y: auto;
        padding: 40px 20px 20px 20px;
        display: flex;
        align-items: flex-start;
        justify-content: center;
      }
      .answer-content {
        max-width: 800px;
        width: 100%;
      }
      .answer-question {
        text-align: center;
        font-size: 1.8rem;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 40px;
      }
      .answer-options {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-bottom: 30px;
      }
      .answer-option {
        background: white;
        border: 3px solid #e0e0e0;
        border-radius: 16px;
        padding: 30px 20px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .answer-option:hover {
        border-color: #5b7cff;
        transform: translateY(-4px);
        box-shadow: 0 8px 20px rgba(91, 124, 255, 0.2);
      }
      .answer-option.selected {
        border-color: #4f5fef;
        background: #f0f4ff;
      }
      .answer-number {
        font-size: 3rem;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 10px;
      }
      .answer-option.selected .answer-number {
        color: #4f5fef;
      }
      .answer-label {
        font-size: 1rem;
        color: #666;
        font-weight: 500;
      }
      .answer-footer {
        background: white;
        padding: 20px;
        border-top: 1px solid #e0e0e0;
        display: flex;
        justify-content: center;
        gap: 15px;
        position: sticky;
        bottom: 0;
        z-index: 10;
      }
      .btn-back {
        padding: 14px 30px;
        background: white;
        color: #333;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
      }
      .btn-continue {
        padding: 14px 40px;
        background: linear-gradient(135deg, #5b7cff, #4f5fef);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(91, 124, 255, 0.3);
      }
      .btn-continue:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      @media (max-width: 768px) {
        .answer-options {
          grid-template-columns: repeat(2, 1fr);
        }
        .dot-test {
          width: 60px;
          height: 60px;
        }
        .answer-question {
          font-size: 1.4rem;
        }
        .answer-number {
          font-size: 2.5rem;
        }
        .btn-next {
          width: 100%;
          padding: 18px 30px;
          font-size: 1.2rem;
        }
        .instructions-body,
        .answer-body {
          padding: 20px 15px 20px 15px;
        }
        .info-card {
          padding: 20px;
        }
        .btn-back,
        .btn-continue {
          flex: 1;
          padding: 16px 20px;
        }
        .instructions-header,
        .instructions-footer {
          padding: 10px;
        }
        .instructions-title {
          font-size: 1.2rem;
        }
        .instructions-subtitle {
          font-size: 0.9rem;
        }
        .step-indicator {
          font-size: 0.75rem;
        }
        .info-card {
          padding: 15px;
          margin-bottom: 15px;
        }
        .info-card-header {
          gap: 10px;
          margin-bottom: 10px;
        }
        .info-icon-full {
          width: 50px;
          height: 50px;
        }
        .info-icon-full svg {
          width: 24px;
          height: 24px;
        }
        .info-title-full {
          font-size: 1.1rem;
        }
        .info-description {
          font-size: 0.95rem;
          margin-bottom: 10px;
        }
        .info-list-full li {
          padding: 8px 0 8px 30px;
          font-size: 0.9rem;
        }
        .info-list-full li::before {
          font-size: 1rem;
        }
      }
      /* ===== PANTALLA DE RESULTADOS ===== */
      #resultsPage {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px;
        overflow-y: auto;
      }
      #resultsPage.active {
        display: block;
      }
      .results-container {
        max-width: 900px;
        margin: 0 auto;
      }
      .results-header {
        background: linear-gradient(135deg, #5b7cff, #4f5fef);
        border-radius: 20px;
        padding: 40px 30px;
        text-align: center;
        margin-bottom: 30px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      }
      .results-check-icon {
        width: 80px;
        height: 80px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        animation: scaleIn 0.5s ease;
      }
      @keyframes scaleIn {
        from {
          transform: scale(0);
        }
        to {
          transform: scale(1);
        }
      }
      .results-check-icon svg {
        width: 50px;
        height: 50px;
        stroke: #4f5fef;
        stroke-width: 3;
        fill: none;
      }
      .results-title {
        font-size: 2rem;
        color: white;
        font-weight: 700;
        margin-bottom: 10px;
      }
      .results-subtitle {
        color: rgba(255, 255, 255, 0.9);
        font-size: 1.1rem;
        margin-bottom: 5px;
      }
      .test-info {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.95rem;
      }
      .results-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 25px;
      }
      .result-card {
        background: white;
        border-radius: 16px;
        padding: 25px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }
      .result-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      .result-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: #1a1a1a;
      }
      .result-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: #4f5fef;
      }
      .alert-box {
        background: white;
        border-radius: 12px;
        padding: 15px;
        margin-bottom: 15px;
        display: flex;
        gap: 12px;
      }
      .alert-box.warning {
        background: #fff9e6;
        border-left: 4px solid #ffc107;
      }
      .alert-box.success {
        background: #e8f5e9;
        border-left: 4px solid #4caf50;
      }
      .alert-box.error {
        background: #ffebee;
        border-left: 4px solid #f44336;
      }
      .alert-icon {
        width: 24px;
        height: 24px;
        flex-shrink: 0;
      }
      .alert-icon svg {
        width: 100%;
        height: 100%;
      }
      .alert-content {
        flex: 1;
      }
      .alert-title {
        font-weight: 600;
        margin-bottom: 5px;
        font-size: 1rem;
      }
      .alert-box.warning .alert-title {
        color: #f57c00;
      }
      .alert-box.success .alert-title {
        color: #2e7d32;
      }
      .alert-box.error .alert-title {
        color: #c62828;
      }
      .alert-description {
        color: #666;
        font-size: 0.9rem;
        line-height: 1.5;
      }
      .vision-display {
        background: white;
        border-radius: 12px;
        padding: 15px;
        margin-top: 15px;
      }
      .display-title {
        text-align: center;
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 12px;
        font-weight: 500;
      }
      .dots-canvas {
        background: #000;
        border-radius: 8px;
        height: 180px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .mini-dot {
        position: absolute;
        border-radius: 50%;
        width: 28px;
        height: 28px;
      }
      /* Patr√≥n A: Fusi√≥n (4 puntos normales) */
      .pattern-fusion .mini-dot-white {
        background: white;
        bottom: 30%;
        left: 50%;
        transform: translateX(-50%);
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
      }
      .pattern-fusion .mini-dot-red-1 {
        background: #ff0000;
        top: 30%;
        left: 50%;
        transform: translateX(-50%);
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.8);
      }
      .pattern-fusion .mini-dot-red-2 {
        background: #00ff00;
        top: 50%;
        left: 15%;
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
      }
      .pattern-fusion .mini-dot-green {
        background: #00ff00;
        top: 50%;
        right: 15%;
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
      }
      /* Patr√≥n B: Supresi√≥n OI (2 rojos) */
      .pattern-supresion-oi .mini-dot-red-1 {
        background: #ff0000;
        top: 40%;
        left: 50%;
        transform: translateX(-50%);
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.8);
      }
      .pattern-supresion-oi .mini-dot-red-2 {
        background: #ff0000;
        bottom: 40%;
        left: 50%;
        transform: translateX(-50%);
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.8);
      }
      /* Patr√≥n C: Supresi√≥n OD (3 verdes) */
      .pattern-supresion-od .mini-dot-green-1 {
        background: #00ff00;
        top: 30%;
        left: 30%;
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
      }
      .pattern-supresion-od .mini-dot-green-2 {
        background: #00ff00;
        top: 30%;
        right: 30%;
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
      }
      .pattern-supresion-od .mini-dot-green-3 {
        background: #00ff00;
        bottom: 30%;
        left: 50%;
        transform: translateX(-50%);
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
      }
      /* Patr√≥n D: Endo (5 puntos) */
      .pattern-endo .mini-dot-red-1 {
        background: #ff0000;
        top: 30%;
        left: 20%;
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.8);
      }
      .pattern-endo .mini-dot-red-2 {
        background: #ff0000;
        bottom: 30%;
        left: 20%;
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.8);
      }
      .pattern-endo .mini-dot-green-1 {
        background: #00ff00;
        top: 25%;
        right: 20%;
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
      }
      .pattern-endo .mini-dot-green-2 {
        background: #00ff00;
        top: 50%;
        right: 20%;
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
      }
      .pattern-endo .mini-dot-green-3 {
        background: #00ff00;
        bottom: 25%;
        right: 20%;
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
      }
      .dots-description {
        text-align: center;
        font-size: 0.85rem;
        color: #666;
        margin-top: 10px;
      }
      .important-note {
        background: #fff9e6;
        border: 2px solid #ffd54f;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 25px;
        display: flex;
        gap: 15px;
      }
      .note-icon {
        width: 24px;
        height: 24px;
        flex-shrink: 0;
      }
      .note-icon svg {
        width: 100%;
        height: 100%;
        stroke: #f57c00;
        fill: none;
        stroke-width: 2;
      }
      .note-content {
        flex: 1;
      }
      .note-title {
        font-weight: 600;
        color: #f57c00;
        margin-bottom: 8px;
        font-size: 1rem;
      }
      .note-text {
        color: #666;
        line-height: 1.6;
        font-size: 0.95rem;
      }
      .action-button {
        display: flex;
        justify-content: center;
      }
      .btn-repeat {
        background: linear-gradient(135deg, #5b7cff, #4f5fef);
        color: white;
        border: none;
        padding: 16px 40px;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 6px 20px rgba(91, 124, 255, 0.4);
        transition: all 0.3s ease;
      }
      .btn-repeat:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(91, 124, 255, 0.5);
      }
      .btn-repeat svg {
        width: 20px;
        height: 20px;
        stroke: white;
        fill: none;
        stroke-width: 2;
      }
      @media (max-width: 768px) {
        .results-grid {
          grid-template-columns: 1fr;
        }
        .results-title {
          font-size: 1.5rem;
        }
        .results-header {
          padding: 30px 20px;
        }
        .result-card {
          padding: 20px;
        }
      }
      @media (orientation: landscape) {
        body {
          padding: 10px;
        }
        .header {
          margin-bottom: 15px;
        }
        .icon-circle {
          width: 60px;
          height: 60px;
          margin-bottom: 10px;
        }
        .icon-circle svg {
          width: 30px;
          height: 30px;
        }
        h1 {
          font-size: 1.8rem;
          margin-bottom: 5px;
        }
        .subtitle {
          font-size: 0.9rem;
        }
        .info-box {
          padding: 15px;
          margin-bottom: 15px;
        }
        .info-header {
          gap: 8px;
          margin-bottom: 10px;
        }
        .info-title {
          font-size: 0.9rem;
        }
        .info-list li {
          margin-bottom: 8px;
          padding-left: 25px;
          font-size: 0.85rem;
        }
        .eye-cards {
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
          margin-bottom: 15px;
        }
        .eye-card {
          padding: 15px 10px;
        }
        .eye-icon {
          width: 40px;
          height: 40px;
          margin-bottom: 8px;
        }
        .eye-title {
          font-size: 1rem;
        }
        .eye-description {
          font-size: 0.8rem;
        }
        .button-group {
          gap: 10px;
          flex-direction: row;
        }
        .btn {
          padding: 12px 20px;
          font-size: 0.9rem;
        }
        .instructions-header,
        .instructions-footer,
        .answer-header,
        .answer-footer {
          padding: 10px;
        }
        .instructions-body,
        .answer-body {
          padding: 10px 10px 10px 10px;
        }
        .info-card {
          padding: 15px;
          margin-bottom: 10px;
        }
        .info-card-header {
          gap: 8px;
          margin-bottom: 10px;
        }
        .info-icon-full {
          width: 40px;
          height: 40px;
        }
        .info-icon-full svg {
          width: 20px;
          height: 20px;
        }
        .info-title-full {
          font-size: 1.1rem;
        }
        .info-description {
          font-size: 0.9rem;
          margin-bottom: 10px;
        }
        .info-list-full li {
          padding: 8px 0 8px 25px;
          font-size: 0.85rem;
        }
        .instructions-title,
        .answer-question {
          font-size: 1.2rem;
        }
        .instructions-subtitle {
          font-size: 0.85rem;
        }
        .step-indicator {
          font-size: 0.75rem;
          padding: 4px 8px;
        }
        .btn-next,
        .btn-continue {
          padding: 12px 30px;
          font-size: 1rem;
        }
        .btn-back {
          padding: 12px 30px;
          font-size: 1rem;
        }
        .answer-options {
          gap: 10px;
        }
        .answer-option {
          padding: 15px 10px;
        }
        .answer-number {
          font-size: 2rem;
        }
        .answer-label {
          font-size: 0.85rem;
        }
        .instructions-body,
        .answer-body {
          min-height: 100px;
        }
        #resultsPage {
          padding: 10px;
        }
        .results-header {
          padding: 20px 15px;
          margin-bottom: 15px;
        }
        .results-check-icon {
          width: 60px;
          height: 60px;
          margin-bottom: 10px;
        }
        .results-check-icon svg {
          width: 35px;
          height: 35px;
        }
        .results-title {
          font-size: 1.6rem;
          margin-bottom: 5px;
        }
        .results-subtitle {
          font-size: 0.95rem;
          margin-bottom: 3px;
        }
        .test-info {
          font-size: 0.85rem;
        }
        .results-grid {
          grid-template-columns: 1fr 1fr;
          gap: 10px;
          margin-bottom: 15px;
        }
        .result-card {
          padding: 15px;
        }
        .result-header {
          margin-bottom: 10px;
        }
        .result-title {
          font-size: 1.1rem;
        }
        .result-number {
          font-size: 2rem;
        }
        .alert-box {
          padding: 10px;
          margin-bottom: 10px;
          gap: 8px;
        }
        .alert-title {
          font-size: 0.9rem;
        }
        .alert-description {
          font-size: 0.8rem;
        }
        .vision-display {
          padding: 10px;
          margin-top: 10px;
        }
        .display-title {
          font-size: 0.8rem;
          margin-bottom: 8px;
        }
        .dots-canvas {
          height: 120px;
        }
        .mini-dot {
          width: 20px;
          height: 20px;
        }
        .dots-description {
          font-size: 0.75rem;
          margin-top: 5px;
        }
        .important-note {
          padding: 15px;
          margin-bottom: 15px;
          gap: 10px;
        }
        .note-title {
          font-size: 0.9rem;
          margin-bottom: 5px;
        }
        .note-text {
          font-size: 0.85rem;
        }
        .btn-repeat {
          padding: 12px 30px;
          font-size: 1rem;
        }
        .btn-repeat svg {
          width: 16px;
          height: 16px;
        }
        .config-header {
          margin-bottom: 15px;
          gap: 10px;
        }
        .config-icon {
          width: 40px;
          height: 40px;
        }
        .config-icon svg {
          width: 20px;
          height: 20px;
        }
        h2 {
          font-size: 1.5rem;
        }
        .section-title {
          font-size: 0.9rem;
          margin-bottom: 10px;
          gap: 5px;
        }
        .section-title svg {
          width: 16px;
          height: 16px;
        }
        .option-card {
          padding: 15px;
          margin-bottom: 10px;
        }
        .option-header {
          margin-bottom: 5px;
        }
        .option-left {
          gap: 8px;
        }
        .option-icon {
          width: 20px;
          height: 20px;
        }
        .option-title {
          font-size: 0.9rem;
        }
        .check-icon {
          width: 20px;
          height: 20px;
        }
        .check-icon svg {
          width: 12px;
          height: 12px;
        }
        .option-description {
          font-size: 0.8rem;
          margin-left: 28px;
        }
        .distance-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
          margin-bottom: 15px;
        }
        .distance-card {
          padding: 12px;
        }
        .distance-main {
          font-size: 1.5rem;
          margin-bottom: 3px;
        }
        .distance-sub {
          font-size: 0.75rem;
          margin-bottom: 5px;
        }
        .distance-detail {
          font-size: 0.7rem;
          margin-bottom: 5px;
        }
        .distance-detail svg {
          width: 12px;
          height: 12px;
        }
        .vision-badge {
          padding: 3px 8px;
          font-size: 0.65rem;
        }
        .distance-check {
          top: 8px;
          right: 8px;
          width: 16px;
          height: 16px;
        }
        .distance-check svg {
          width: 10px;
          height: 10px;
        }
        .advanced-section {
          padding: 15px;
          margin-bottom: 15px;
        }
        .advanced-title {
          margin-bottom: 15px;
          font-size: 1rem;
        }
        .slider-group {
          margin-bottom: 15px;
        }
        .slider-label {
          font-size: 0.8rem;
          margin-bottom: 5px;
        }
        .slider-range {
          font-size: 0.7rem;
        }
        input[type="range"] {
          height: 5px;
        }
        input[type="range"]::-webkit-slider-thumb {
          width: 15px;
          height: 15px;
        }
        input[type="range"]::-moz-range-thumb {
          width: 15px;
          height: 15px;
        }
        .color-options {
          grid-template-columns: repeat(3, 1fr);
          gap: 10px;
          margin-bottom: 15px;
        }
        .color-option {
          padding: 10px;
        }
        .color-sample {
          height: 30px;
          margin-bottom: 5px;
        }
        .color-label {
          font-size: 0.75rem;
        }
        .preview-section {
          padding: 15px;
          margin-bottom: 15px;
        }
        .preview-title {
          margin-bottom: 15px;
          font-size: 0.9rem;
        }
        .preview-canvas {
          width: min(100%, 300px);
        }
        .preview-info {
          font-size: 0.75rem;
          margin-top: 10px;
        }
      }

      /* =========================================================
   AJUSTE ESPECIAL PARA IPHONE (Super Retina XDR)
   Hace que rojo y verde sean HIPER‚Äìopacos SOLO en iOS.
   ========================================================= */
      @supports (-webkit-touch-callout: none) {
        /* üî¥ Rojo hiper‚Äìopaco solo en iPhone */
        .dot-red,
        .dot-red-1,
        .mini-dot-red-1,
        .pattern-fusion .mini-dot-red-1,
        .pattern-supresion-oi .mini-dot-red-1,
        .pattern-endo .mini-dot-red-1,
        .pattern-endo .mini-dot-red-2 {
          background: rgb(8, 0, 0) !important;
        }

        /* üü¢ Verde hiper‚Äìopaco solo en iPhone */
        .dot-red-right,
        .dot-red-2,
        .dot-green,
        .dot-green-test,
        .mini-dot-green,
        .mini-dot-green-1,
        .mini-dot-green-2,
        .mini-dot-green-3,
        .pattern-fusion .mini-dot-red-2,
        .pattern-fusion .mini-dot-green {
          background: rgb(0, 8, 0) !important;
        }

        /* ‚ùó Mantener blanco brillante */
        .dot-white,
        .dot-white-test,
        .mini-dot-white {
          background: #ffffff !important;
          box-shadow: 0 0 22px rgba(255, 255, 255, 0.95) !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- P√ÅGINA PRINCIPAL -->
      <div id="homePage" class="page active">
        <div class="header">
          <div class="icon-circle">
            <svg viewBox="0 0 24 24">
              <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z" />
              <circle cx="12" cy="12" r="3" />
            </svg>
          </div>
          <h1>Test de Worth</h1>
          <p class="subtitle">
            Evaluaci√≥n de visi√≥n binocular y detecci√≥n de supresi√≥n o diplop√≠a
          </p>
        </div>
        <div class="info-box">
          <div class="info-header">
            <div class="info-icon">i</div>
            <span class="info-title">Instrucciones importantes:</span>
          </div>
          <ol class="info-list">
            <li>
              En configuraci√≥n, elija si usar√°
              <strong>gafas rojo-verde</strong> o tapar√° un ojo manualmente.
            </li>
            <li>
              Seleccione la <strong>distancia exacta</strong> a la que realizar√°
              el test (40 o 50 cm).
            </li>
            <li>
              Durante el test, siga las instrucciones sobre qu√© ojo cubrir.
            </li>
            <li>Cuente cu√°ntos puntos ve en total y responda honestamente.</li>
          </ol>
        </div>
        <div class="eye-cards">
          <div class="eye-card left">
            <div class="eye-icon">
              <svg viewBox="0 0 24 24">
                <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z" />
                <circle cx="12" cy="12" r="3" />
              </svg>
            </div>
            <div class="eye-title">Ojo Derecho</div>
            <div class="eye-description">Con filtro rojo - Ve puntos rojos</div>
          </div>
          <div class="eye-card right">
            <div class="eye-icon">
              <svg viewBox="0 0 24 24">
                <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z" />
                <circle cx="12" cy="12" r="3" />
              </svg>
            </div>
            <div class="eye-title">Ojo Izquierdo</div>
            <div class="eye-description">
              Con filtro verde - Ve puntos verdes
            </div>
          </div>
        </div>
        <div class="button-group">
          <button class="btn btn-secondary" onclick="showConfig()">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="3" />
              <path d="M12 1v6m0 6v6" />
              <path d="M17 7l-5 5-5-5" />
              <path d="M17 17l-5-5-5 5" />
            </svg>
            Configurar Test
          </button>
          <button class="btn btn-primary" onclick="startTest()">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z" />
              <circle cx="12" cy="12" r="3" />
            </svg>
            Comenzar Test
          </button>
        </div>
      </div>
      <!-- P√ÅGINA DE CONFIGURACI√ìN -->
      <div id="configPage" class="page">
        <div class="config-header">
          <div class="config-icon">
            <svg viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="3" />
              <path d="M12 1v6m0 6v6" />
              <path d="M17 7l-5 5-5-5" />
              <path d="M17 17l-5-5-5 5" />
            </svg>
          </div>
          <h2>Configuraci√≥n del Test</h2>
        </div>
        <div class="section-title">Modo de visualizaci√≥n</div>
        <div class="option-card selected" onclick="selectMode('glasses', this)">
          <div class="option-header">
            <div class="option-left">
              <div class="option-icon">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z" />
                  <circle cx="12" cy="12" r="3" />
                </svg>
              </div>
              <span class="option-title">Con Gafas Rojo-Verde (Anaglifo)</span>
            </div>
            <div class="check-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                <polyline points="20 6 9 17 4 12" />
              </svg>
            </div>
          </div>
          <div class="option-description">
            Use gafas especiales con filtro rojo en el ojo derecho y verde en el
            izquierdo. Esta es la forma est√°ndar del test de Worth.
          </div>
        </div>
        <div class="option-card" onclick="selectMode('manual', this)">
          <div class="option-header">
            <div class="option-left">
              <div class="option-icon">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"
                  />
                  <line x1="1" y1="1" x2="23" y2="23" />
                  <path d="M10.66 5.41a10 10 0 0 1 11.34 6.59" />
                </svg>
              </div>
              <span class="option-title"
                >Sin Gafas (Tapar Ojos Manualmente)</span
              >
            </div>
            <div class="check-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                <polyline points="20 6 9 17 4 12" />
              </svg>
            </div>
          </div>
          <div class="option-description">
            El test le indicar√° qu√© ojo debe tapar en cada momento. √ötil si no
            tiene gafas rojo-verde disponibles.
          </div>
        </div>
        <div class="section-title" style="margin-top: 30px">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
          </svg>
          Distancia de visualizaci√≥n
        </div>
        <div class="distance-grid">
          <div
            class="distance-card selected"
            onclick="selectDistance(40, this)"
          >
            <div class="distance-check">
              <svg viewBox="0 0 24 24" fill="none">
                <polyline points="20 6 9 17 4 12" />
              </svg>
            </div>
            <div class="distance-main">40 cm</div>
            <div class="distance-sub">Visi√≥n cercana (est√°ndar)</div>
            <div class="distance-detail">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="3" y="3" width="18" height="18" rx="2" />
              </svg>
              C√≠rculos: 80px
            </div>
            <span class="vision-badge badge-cerca">Visi√≥n Cercana</span>
          </div>
          <div class="distance-card" onclick="selectDistance(50, this)">
            <div class="distance-check">
              <svg viewBox="0 0 24 24" fill="none">
                <polyline points="20 6 9 17 4 12" />
              </svg>
            </div>
            <div class="distance-main">50 cm</div>
            <div class="distance-sub">Visi√≥n cercana alternativa</div>
            <div class="distance-detail">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="3" y="3" width="18" height="18" rx="2" />
              </svg>
              C√≠rculos: 64px
            </div>
            <span class="vision-badge badge-cerca">Visi√≥n Cercana</span>
          </div>
        </div>
        <!-- Nueva secci√≥n para forma de puntos -->
        <div class="section-title" style="margin-top: 30px">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="10" />
          </svg>
          Forma de los puntos
        </div>
        <div
          class="option-card selected"
          onclick="selectShape('circular', this)"
        >
          <div class="option-header">
            <div class="option-left">
              <div class="option-icon">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                </svg>
              </div>
              <span class="option-title">Circular</span>
            </div>
            <div class="check-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                <polyline points="20 6 9 17 4 12" />
              </svg>
            </div>
          </div>
          <div class="option-description">Todos los puntos son c√≠rculos.</div>
        </div>
        <div class="option-card" onclick="selectShape('shaped', this)">
          <div class="option-header">
            <div class="option-left">
              <div class="option-icon">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M12 2L2 12L12 22L22 12Z" />
                </svg>
              </div>
              <span class="option-title">Figuras</span>
            </div>
            <div class="check-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                <polyline points="20 6 9 17 4 12" />
              </svg>
            </div>
          </div>
          <div class="option-description">
            Rojo: diamante, Verdes: cruces, Blanco: c√≠rculo.
          </div>
        </div>
        <!-- Ajustes avanzados -->
        <div class="advanced-section">
          <div class="advanced-title">Ajustes avanzados</div>

          <div class="slider-group">
            <div class="slider-label">
              <span>Brillo: <strong id="brightnessValue">100</strong>%</span>
              <span class="slider-range"
                >Tenue (50%) - Muy brillante (150%)</span
              >
            </div>
            <input
              type="range"
              id="brightness"
              min="50"
              max="150"
              value="100"
              oninput="updateBrightness(this.value)"
            />
          </div>
          <div class="slider-group">
            <div class="slider-label">
              <span
                >Intensidad del resplandor:
                <strong id="glowValue">80</strong>%</span
              >
              <span class="slider-range"
                >Sin resplandor - M√°ximo resplandor</span
              >
            </div>
            <input
              type="range"
              id="glow"
              min="0"
              max="100"
              value="80"
              oninput="updateGlow(this.value)"
            />
          </div>
          <div
            style="
              margin-top: 20px;
              margin-bottom: 10px;
              font-weight: 600;
              color: #333;
            "
          >
            Color de fondo
          </div>
          <div class="color-options">
            <div
              class="color-option selected"
              onclick="selectColor('black', this)"
            >
              <div class="color-sample color-black"></div>
              <div class="color-label">Negro</div>
            </div>
            <div class="color-option" onclick="selectColor('dark-gray', this)">
              <div class="color-sample color-dark-gray"></div>
              <div class="color-label">Gris oscuro</div>
            </div>
            <div class="color-option" onclick="selectColor('gray', this)">
              <div class="color-sample color-gray"></div>
              <div class="color-label">Gris medio</div>
            </div>
          </div>
        </div>
        <!-- Vista Previa -->
        <div class="preview-section">
          <div class="preview-title">
            Vista previa - Distancia: <span id="previewDistance">40 cm</span>
          </div>
          <div class="preview-canvas" id="previewCanvas">
            <!-- <<< AQU√ç A√ëADIMOS glow-dot SOLO A LA BLANCA >>> -->
            <div class="dot dot-white glow-dot" id="dotWhite"></div>
            <div class="dot dot-red" id="dotRed1"></div>
            <div class="dot dot-red-right" id="dotRed2"></div>
            <div class="dot dot-green" id="dotGreen"></div>
          </div>
          <div class="preview-info">
            Tama√±o de c√≠rculos: <span id="dotSize">80px</span> | Espaciamiento:
            <span id="spacing">1.0x</span>
          </div>
        </div>
        <!-- Botones -->
        <div class="button-group">
          <button class="btn btn-secondary" onclick="showHome()">Volver</button>
          <button class="btn btn-primary" onclick="startTestFromConfig()">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z" />
              <circle cx="12" cy="12" r="3" />
            </svg>
            Comenzar Test a <span id="startDistance">40</span> cm
          </button>
        </div>
      </div>
    </div>
    <!-- PANTALLA 1: INSTRUCCIONES (FULLSCREEN) -->
    <div id="instructionsPage" class="page">
      <div class="instructions-header">
        <div>
          <div class="instructions-title">Test de Worth</div>
          <div class="instructions-subtitle">
            Mant√©ngase a <span class="distance-display">40 cm</span> de la
            pantalla
          </div>
        </div>
        <div class="step-indicator">Preparaci√≥n</div>
      </div>
      <div class="instructions-body">
        <div class="instructions-content">
          <div class="info-card">
            <div class="info-card-header">
              <div class="info-icon-full">
                <svg viewBox="0 0 24 24">
                  <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z" />
                  <circle cx="12" cy="12" r="3" />
                </svg>
              </div>
              <div class="info-title-full">Use Gafas Rojo-Verde (Anaglifo)</div>
            </div>

            <div class="info-description">
              Coloque las gafas con el filtro ROJO sobre el OJO DERECHO y el
              filtro VERDE sobre el OJO IZQUIERDO. Mantenga ambos ojos abiertos.
            </div>

            <ul class="info-list-full">
              <li><strong>üî¥ Filtro ROJO</strong> ‚Äî Ojo DERECHO</li>
              <li><strong>üü¢ Filtro VERDE</strong> ‚Äî Ojo IZQUIERDO</li>
              <li><strong>üëÅÔ∏è Ambos ojos</strong> abiertos y relajados</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="instructions-footer">
        <button class="btn-back" onclick="showHome()">Volver</button>
        <button class="btn-next" onclick="showTest()">Comenzar Test</button>
      </div>
    </div>
    <!-- PANTALLA 2: TEST CON PUNTOS (FULLSCREEN) -->
    <div id="testPage" class="page">
      <div class="test-header">
        <div>
          <div class="test-title">Test de Worth</div>
          <div class="test-subtitle">Observe los puntos con atenci√≥n</div>
        </div>
        <div class="test-step">Evaluando...</div>
      </div>
      <div class="test-canvas-container">
        <div class="test-area">
          <!-- <<< AQU√ç TAMBI√âN A√ëADIMOS glow-dot SOLO AL BLANCO >>> -->
          <div class="dot-test dot-white-test glow-dot"></div>
          <div class="dot-test dot-red-1"></div>
          <div class="dot-test dot-red-2"></div>
          <div class="dot-test dot-green-test"></div>
        </div>
      </div>
      <div class="test-footer">
        <button class="btn-back" onclick="showInstructions()">Volver</button>
        <button class="btn-next" onclick="showAnswers()">Siguiente</button>
      </div>
    </div>
    <!-- PANTALLA 3: SELECCI√ìN DE RESPUESTA (FULLSCREEN) -->
    <div id="answerPage" class="page">
      <div class="answer-header">
        <div>
          <div class="instructions-title">Test de Worth</div>
          <div class="instructions-subtitle">
            Distancia: <span class="distance-display">40 cm</span>
          </div>
        </div>
        <div class="step-indicator">Respuesta</div>
      </div>
      <div class="answer-body">
        <div class="answer-content">
          <div class="answer-question">¬øCu√°ntos puntos ve en total?</div>

          <div class="answer-options">
            <div class="answer-option" onclick="selectAnswer(2, this)">
              <div class="answer-number">2</div>
              <div class="answer-label">Dos puntos</div>
            </div>
            <div class="answer-option" onclick="selectAnswer(3, this)">
              <div class="answer-number">3</div>
              <div class="answer-label">Tres puntos</div>
            </div>
            <div class="answer-option" onclick="selectAnswer(4, this)">
              <div class="answer-number">4</div>
              <div class="answer-label">Cuatro puntos</div>
            </div>
            <div class="answer-option" onclick="selectAnswer(5, this)">
              <div class="answer-number">5</div>
              <div class="answer-label">Cinco puntos</div>
            </div>
          </div>
        </div>
      </div>
      <div class="answer-footer">
        <button class="btn-back" onclick="showTest()">Volver</button>
        <button
          class="btn-continue"
          id="continueBtn"
          onclick="continueToNext()"
          disabled
        >
          Ver resultados
        </button>
      </div>
    </div>
    <!-- PANTALLA 4: RESULTADOS -->
    <div id="resultsPage" class="page">
      <div class="results-container">
        <div class="results-header">
          <div class="results-check-icon">
            <svg viewBox="0 0 24 24">
              <polyline points="20 6 9 17 4 12" />
            </svg>
          </div>
          <h1 class="results-title">Resultados del Test de Worth</h1>
          <p class="results-subtitle">
            Evaluaci√≥n de visi√≥n binocular completada
          </p>
          <p class="test-info">
            Test realizado a <span id="testDistance">40</span> cm
          </p>
        </div>
        <div class="results-grid">
          <!-- Resultado del Test -->
          <div class="result-card">
            <div class="result-header">
              <h2 class="result-title">Resultado</h2>
              <div class="result-number" id="resultNumber">4</div>
            </div>
            <div class="alert-box success" id="resultAlert">
              <div class="alert-icon">
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="#4caf50"
                  stroke-width="2"
                >
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                  <polyline points="22 4 12 14.01 9 11.01" />
                </svg>
              </div>
              <div class="alert-content">
                <div class="alert-title" id="resultTitle">
                  Visi√≥n Binocular Normal
                </div>
                <div class="alert-description" id="resultDesc">
                  Fusi√≥n binocular normal. Ambos ojos est√°n trabajando juntos
                  correctamente.
                </div>
              </div>
            </div>
            <div class="vision-display">
              <div class="display-title">Lo que vio el paciente:</div>
              <div class="dots-canvas pattern-fusion" id="resultCanvas">
                <!-- Puntos se generan din√°micamente -->
              </div>
              <div class="dots-description" id="resultPattern">
                4 puntos normales (fusi√≥n correcta)
              </div>
            </div>
          </div>
          <!-- Informaci√≥n adicional -->
          <div class="result-card">
            <div class="result-header">
              <h2 class="result-title">Interpretaci√≥n</h2>
            </div>
            <div style="color: #666; line-height: 1.6; font-size: 0.95rem">
              <p style="margin-bottom: 15px">
                <strong>Puntos visibles:</strong>
                <span id="pointsVisible">4 puntos</span>
              </p>
              <p style="margin-bottom: 15px">
                <strong>Significado cl√≠nico:</strong>
                <span id="clinicalMeaning"
                  >Indica fusi√≥n binocular normal y ausencia de supresi√≥n.</span
                >
              </p>
              <p style="margin-bottom: 15px">
                <strong>Distancia evaluada:</strong>
                <span id="distanceEval">40 cm (visi√≥n cercana)</span>
              </p>
              <div
                style="
                  margin-top: 20px;
                  padding: 15px;
                  background: #f5f5f5;
                  border-radius: 8px;
                "
              >
                <strong style="color: #333">Recomendaci√≥n:</strong>
                <p style="margin-top: 8px; color: #666" id="recommendation">
                  Los resultados sugieren una funci√≥n binocular adecuada. Se
                  recomienda evaluaci√≥n peri√≥dica.
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="important-note">
          <div class="note-icon">
            <svg viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10" />
              <line x1="12" y1="16" x2="12" y2="12" />
              <line x1="12" y1="8" x2="12.01" y2="8" />
            </svg>
          </div>
          <div class="note-content">
            <div class="note-title">Nota Importante</div>
            <div class="note-text">
              Este test es solo una herramienta de evaluaci√≥n preliminar. Los
              resultados deben ser interpretados por un profesional de la salud
              visual. Si detecta anomal√≠as, consulte con un oftalm√≥logo u
              optometrista calificado.
            </div>
          </div>
        </div>
        <div class="action-button">
          <button class="btn-repeat" onclick="repeatTest()">
            <svg viewBox="0 0 24 24">
              <path
                d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"
              />
            </svg>
            Realizar Test Nuevamente
          </button>
        </div>
      </div>
    </div>
    <script>
      let config = {
        mode: "glasses",
        distance: 40,
        brightness: 100,
        glow: 80,
        backgroundColor: "black",
        shape: "circular",
        dotSizes: {
          40: 80,
          50: 64,
        },
      };
      let selectedAnswer = null;
      let testResults = {
        distance: 40,
        points: 4,
      };
      // Funci√≥n para activar pantalla completa
      function requestFullscreen() {
        const elem = document.documentElement;
        if (elem.requestFullscreen) {
          elem.requestFullscreen().catch((err) => {
            console.log("No se pudo activar pantalla completa:", err);
          });
        } else if (elem.webkitRequestFullscreen) {
          /* Safari */
          elem.webkitRequestFullscreen();
        } else if (elem.msRequestFullscreen) {
          /* IE11 */
          elem.msRequestFullscreen();
        }
      }
      // Intentar activar pantalla completa al cargar
      window.addEventListener("load", function () {
        // En m√≥viles, necesitamos esperar a una interacci√≥n del usuario
        document.addEventListener(
          "click",
          function enableFullscreen() {
            requestFullscreen();
            // Remover el listener despu√©s de la primera activaci√≥n
            document.removeEventListener("click", enableFullscreen);
          },
          { once: true }
        );
      });
      function showHome() {
        document.getElementById("homePage").classList.add("active");
        document.getElementById("configPage").classList.remove("active");
        document.getElementById("instructionsPage").classList.remove("active");
        document.getElementById("testPage").classList.remove("active");
        document.getElementById("answerPage").classList.remove("active");
        document.getElementById("resultsPage").classList.remove("active");
      }
      function showConfig() {
        document.getElementById("homePage").classList.remove("active");
        document.getElementById("configPage").classList.add("active");
        document.getElementById("instructionsPage").classList.remove("active");
        document.getElementById("testPage").classList.remove("active");
        document.getElementById("answerPage").classList.remove("active");
        document.getElementById("resultsPage").classList.remove("active");
      }
      function updateDistanceTexts() {
        const txt = config.distance + " cm";
        document.querySelectorAll(".distance-display").forEach((el) => {
          el.textContent = txt;
        });
      }
      function resetAnswers() {
        selectedAnswer = null;
        document.querySelectorAll(".answer-option").forEach((opt) => {
          opt.classList.remove("selected");
        });
        const btn = document.getElementById("continueBtn");
        if (btn) btn.disabled = true;
      }
      function startTest() {
        resetAnswers();
        updateDistanceTexts();
        try {
          requestFullscreen();
        } catch (e) {
          console.log("Fullscreen not supported");
        }
        document.getElementById("homePage").classList.remove("active");
        document.getElementById("configPage").classList.remove("active");
        document.getElementById("testPage").classList.remove("active");
        document.getElementById("answerPage").classList.remove("active");
        document.getElementById("resultsPage").classList.remove("active");
        document.getElementById("instructionsPage").classList.add("active");
      }
      function startTestFromConfig() {
        startTest();
      }
      function selectMode(mode, element) {
        config.mode = mode;
        document.querySelectorAll(".option-card").forEach((card) => {
          card.classList.remove("selected");
        });
        element.classList.add("selected");
      }
      function selectDistance(distance, element) {
        config.distance = distance;
        document.querySelectorAll(".distance-card").forEach((card) => {
          card.classList.remove("selected");
        });
        element.classList.add("selected");

        document.getElementById("previewDistance").textContent =
          distance + " cm";
        document.getElementById("startDistance").textContent = distance;
        updateDotSizes();
        updateDistanceTexts();
      }
      function selectColor(color, element) {
        config.backgroundColor = color;
        document.querySelectorAll(".color-option").forEach((option) => {
          option.classList.remove("selected");
        });
        element.classList.add("selected");

        let background;
        if (color === "black") background = "#000000";
        else if (color === "dark-gray") background = "#333333";
        else if (color === "gray") background = "#808080";

        const previewCanvas = document.getElementById("previewCanvas");
        previewCanvas.style.background = background;

        const testPage = document.getElementById("testPage");
        testPage.style.background = background;

        const testCanvas = document.querySelector(".test-canvas-container");
        if (testCanvas) testCanvas.style.background = background;

        const testHeader = document.querySelector(".test-header");
        if (testHeader) testHeader.style.background = background;

        const testFooter = document.querySelector(".test-footer");
        if (testFooter) testFooter.style.background = background;
      }
      function selectShape(shape, element) {
        config.shape = shape;
        document.querySelectorAll(".option-card").forEach((card) => {
          card.classList.remove("selected");
        });
        element.classList.add("selected");
        updateShapes();
      }
      function updateShapes() {
        const previewDots = document.querySelectorAll("#previewCanvas .dot");
        const testDots = document.querySelectorAll(".test-area .dot-test");
        const allDots = [...previewDots, ...testDots];

        allDots.forEach((dot) => {
          dot.style.borderRadius = "50%";
          dot.style.transform = "";
          dot.style.background =
            dot.getAttribute("data-original-background") ||
            dot.style.background;
          dot.innerHTML = "";
        });

        if (config.shape === "shaped") {
          allDots.forEach((dot) => {
            dot.setAttribute("data-original-background", dot.style.background);
            dot.style.background = "transparent";
            dot.style.borderRadius = "0";
            let svg = "";
            if (
              dot.classList.contains("dot-red") ||
              dot.classList.contains("dot-red-1")
            ) {
              // Diamond for red
              svg =
                '<svg viewBox="0 0 100 100" style="width:100%;height:100%;"><polygon points="50,0 100,50 50,100 0,50" fill="currentColor"/></svg>';
            } else if (
              dot.classList.contains("dot-red-right") ||
              dot.classList.contains("dot-red-2") ||
              dot.classList.contains("dot-green") ||
              dot.classList.contains("dot-green-test")
            ) {
              // Plus for greens
              svg =
                '<svg viewBox="0 0 100 100" style="width:100%;height:100%;"><rect x="40" y="0" width="20" height="100" fill="currentColor"/><rect x="0" y="40" width="100" height="20" fill="currentColor"/></svg>';
            } else if (
              dot.classList.contains("dot-white") ||
              dot.classList.contains("dot-white-test")
            ) {
              // Circle for white
              svg =
                '<svg viewBox="0 0 100 100" style="width:100%;height:100%;"><circle cx="50" cy="50" r="50" fill="currentColor"/></svg>';
            }
            dot.innerHTML = svg;
          });
        }
      }
      function updateBrightness(value) {
        config.brightness = value;
        document.getElementById("brightnessValue").textContent = value;

        // SOLO la bola blanca (las que tienen .glow-dot) cambian de brillo
        document.querySelectorAll(".glow-dot").forEach((dot) => {
          dot.style.filter = `brightness(${value}%)`;
        });
      }

      // <<< CAMBIO IMPORTANTE: solo aplicamos resplandor a .glow-dot >>>
      function updateGlow(value) {
        config.glow = value;
        document.getElementById("glowValue").textContent = value;

        const glowSize = value / 5;
        document.querySelectorAll(".glow-dot").forEach((dot) => {
          dot.style.boxShadow = `0 0 ${glowSize}px rgba(255, 255, 255, 0.9)`;
        });
      }

      // <<< FIN CAMBIO >>>

      function updateDotSizes() {
        const size = config.dotSizes[config.distance];
        document.getElementById("dotSize").textContent = size + "px";

        document.querySelectorAll(".dot, .dot-test").forEach((dot) => {
          dot.style.width = size + "px";
          dot.style.height = size + "px";
        });
      }
      // Variable para controlar el listener
      let canvasClickListener = null;
      // Flujo del test fullscreen
      function showTest() {
        document.getElementById("instructionsPage").classList.remove("active");
        document.getElementById("answerPage").classList.remove("active");
        document.getElementById("testPage").classList.add("active");

        const header = document.querySelector("#testPage .test-header");
        const footer = document.querySelector("#testPage .test-footer");
        const canvas = document.querySelector(".test-canvas-container");

        // Asegurar que header y footer est√©n visibles al inicio
        if (header) header.classList.remove("hidden");
        if (footer) footer.classList.remove("hidden");

        // Ocultar header y footer autom√°ticamente despu√©s de 2 segundos
        setTimeout(() => {
          if (header) header.classList.add("hidden");
          if (footer) footer.classList.add("hidden");
        }, 2000);

        // Remover listener anterior si existe
        if (canvasClickListener && canvas) {
          canvas.removeEventListener("click", canvasClickListener);
        }

        // Crear nuevo listener
        canvasClickListener = function () {
          if (header && footer) {
            header.classList.toggle("hidden");
            footer.classList.toggle("hidden");
          }
        };

        // Agregar el listener
        if (canvas) {
          canvas.addEventListener("click", canvasClickListener);
        }
      }
      function showAnswers() {
        document.getElementById("testPage").classList.remove("active");
        document.getElementById("answerPage").classList.add("active");
      }
      function selectAnswer(value, element) {
        selectedAnswer = value;

        document.querySelectorAll(".answer-option").forEach((opt) => {
          opt.classList.remove("selected");
        });

        element.classList.add("selected");
        document.getElementById("continueBtn").disabled = false;
      }
      // ===== L√ìGICA DE RESULTADOS =====
      function interpretResult(points) {
        const interpretations = {
          2: {
            type: "warning",
            title: "Supresi√≥n del Ojo Izquierdo",
            description:
              "El ojo izquierdo est√° siendo suprimido. El cerebro est√° ignorando la imagen del ojo izquierdo.",
            pattern: "supresion-oi",
            patternDesc: "2 puntos (1 rojo + 1 blanco)",
            clinical:
              "Indica supresi√≥n monocular del ojo izquierdo. Solo ve los est√≠mulos del ojo derecho (rojo y blanco).",
            recommendation:
              "Se recomienda evaluaci√≥n oftalmol√≥gica inmediata para determinar la causa de la supresi√≥n y establecer un plan de tratamiento.",
            dots: [{ class: "mini-dot-red-1" }, { class: "mini-dot-white" }],
          },
          3: {
            type: "warning",
            title: "Supresi√≥n del Ojo Derecho",
            description:
              "El ojo derecho est√° siendo suprimido. El cerebro est√° ignorando la imagen del ojo derecho.",
            pattern: "supresion-od",
            patternDesc: "3 puntos (2 verdes + 1 blanco)",
            clinical:
              "Indica supresi√≥n monocular del ojo derecho. Solo ve los est√≠mulos del ojo izquierdo (verdes y blanco).",
            recommendation:
              "Se recomienda evaluaci√≥n oftalmol√≥gica inmediata para determinar la causa de la supresi√≥n y establecer un plan de tratamiento.",
            dots: [
              { class: "mini-dot-red-2" },
              { class: "mini-dot-green" },
              { class: "mini-dot-white" },
            ],
          },
          4: {
            type: "success",
            title: "Visi√≥n Binocular Normal",
            description:
              "Fusi√≥n binocular normal. Ambos ojos est√°n trabajando juntos correctamente.",
            pattern: "fusion",
            patternDesc:
              "4 puntos normales (1 rojo arriba, 2 verdes laterales, 1 blanco abajo)",
            clinical: "Indica fusi√≥n binocular normal y ausencia de supresi√≥n.",
            recommendation:
              "Los resultados sugieren una funci√≥n binocular adecuada. Se recomienda evaluaci√≥n peri√≥dica.",
            dots: [
              { class: "mini-dot-red-1" },
              { class: "mini-dot-red-2" },
              { class: "mini-dot-green" },
              { class: "mini-dot-white" },
            ],
          },
          5: {
            type: "error",
            title: "Diplop√≠a Detectada",
            description:
              "Se detecta visi√≥n doble. Los ojos no est√°n alineados correctamente.",
            pattern: "endo",
            patternDesc: "5 puntos (diplop√≠a - visi√≥n doble)",
            clinical:
              "Indica diplop√≠a binocular. Puede ser endodesviaci√≥n, exodesviaci√≥n o hiperdesviaci√≥n.",
            recommendation:
              "Se requiere evaluaci√≥n oftalmol√≥gica urgente para determinar el tipo de desviaci√≥n y establecer tratamiento apropiado.",
            dots: [
              { class: "mini-dot-red-1" },
              { class: "mini-dot-red-2" },
              { class: "mini-dot-green-1" },
              { class: "mini-dot-green-2" },
              { class: "mini-dot-green-3" },
            ],
          },
        };
        return interpretations[points] || interpretations[4];
      }
      function renderDots(canvasId, dots) {
        const canvas = document.getElementById(canvasId);
        canvas.innerHTML = "";
        dots.forEach((dot) => {
          const dotEl = document.createElement("div");
          dotEl.className = "mini-dot " + dot.class;
          canvas.appendChild(dotEl);
        });
      }
      function updateResultsUI() {
        const result = interpretResult(testResults.points);

        // Actualizar n√∫mero de puntos
        document.getElementById("resultNumber").textContent =
          testResults.points;
        document.getElementById("testDistance").textContent =
          testResults.distance;

        // Actualizar alert box
        const alertBox = document.getElementById("resultAlert");
        alertBox.className = "alert-box " + result.type;

        const iconColor =
          result.type === "success"
            ? "#4caf50"
            : result.type === "warning"
            ? "#f57c00"
            : "#f44336";
        alertBox
          .querySelector(".alert-icon svg")
          .setAttribute("stroke", iconColor);

        document.getElementById("resultTitle").textContent = result.title;
        document.getElementById("resultDesc").textContent = result.description;

        // Actualizar canvas de visualizaci√≥n
        const canvas = document.getElementById("resultCanvas");
        canvas.className = "dots-canvas pattern-" + result.pattern;
        renderDots("resultCanvas", result.dots);

        document.getElementById("resultPattern").textContent =
          result.patternDesc;

        // Actualizar interpretaci√≥n
        document.getElementById("pointsVisible").textContent =
          testResults.points + " puntos";
        document.getElementById("clinicalMeaning").textContent =
          result.clinical;
        document.getElementById("distanceEval").textContent =
          testResults.distance + " cm (visi√≥n cercana)";
        document.getElementById("recommendation").textContent =
          result.recommendation;
      }
      function showResultsPage() {
        testResults.distance = config.distance;
        testResults.points = selectedAnswer || 4;
        updateResultsUI();
        document.getElementById("instructionsPage").classList.remove("active");
        document.getElementById("testPage").classList.remove("active");
        document.getElementById("answerPage").classList.remove("active");
        document.getElementById("homePage").classList.remove("active");
        document.getElementById("configPage").classList.remove("active");
        document.getElementById("resultsPage").classList.add("active");
      }
      function continueToNext() {
        if (selectedAnswer) {
          showResultsPage();
        }
      }
      function repeatTest() {
        showHome();
      }
      function showInstructions() {
        document.getElementById("testPage").classList.remove("active");
        document.getElementById("instructionsPage").classList.add("active");
      }
      // Inicializar
      updateDotSizes();
      updateBrightness(config.brightness);
      updateGlow(config.glow);
      updateShapes();
    </script>
  </body>
</html>
